(this["webpackJsonpd3-learning"]=this["webpackJsonpd3-learning"]||[]).push([[0],{127:function(t,e,a){t.exports={home:"Home_home__33MBa",content:"Home_content__QwLiU"}},149:function(t,e,a){t.exports={barchart:"BarChat_barchart__5cRVK"}},150:function(t,e,a){t.exports={barChartPage:"BarChartPage_barChartPage__b45Pf"}},151:function(t,e,a){t.exports={linechart:"LineChart_linechart__3h562"}},152:function(t,e,a){t.exports={lineChartPage:"LineChartPage_lineChartPage__287VI"}},153:function(t,e,a){t.exports={piechart:"PieChart_piechart__2u9A2"}},154:function(t,e,a){t.exports={pieChartPage:"PieChartPage_pieChartPage__cnWIt"}},155:function(t,e,a){t.exports={map:"Map_map__UaOG-"}},156:function(t,e,a){t.exports={mapChartPage:"ChinaMapPage_mapChartPage__3U9fV"}},157:function(t,e,a){t.exports={svgTree:"SVGTree_svgTree__3rQmQ"}},158:function(t,e,a){},159:function(t,e,a){t.exports={canvasTree:"CanvasTree_canvasTree__1kuCR"}},160:function(t,e,a){t.exports={CanvasTreePage:"CanvasTreePage_CanvasTreePage__1TQnS"}},168:function(t,e,a){a(169),t.exports=a(247)},183:function(t,e,a){},247:function(t,e,a){"use strict";a.r(e);var n={};a.r(n),a.d(n,"randomColor",(function(){return E})),a.d(n,"getColorStrFromCanvas",(function(){return N}));var r=a(1),i=a.n(r),o=a(8),c=a.n(o),s=(a(183),a(248),a(35)),l=(a(186),a(57)),u=a(40),d=a(49),h=a(127),f=a.n(h);var g=function(){return i.a.createElement("div",{className:f.a.home},i.a.createElement("div",{className:f.a.content},"\u8fd9\u662fD3\u5de5\u7a0b"))},m=a(19),v=a.n(m),p=a(33),y=a(4),x=a(6),b=a.n(x),_=a(25),C=a.n(_),k=a(103);function E(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e="#",a=0;a<6;a++)e+=t[Math.floor(16*Math.random())];return e}function w(t){return 2!==t.length?"0"+t:t}function N(t,e,a){var n=t.getImageData(e,a,1,1).data;return"#"+w(n[0].toString(16))+w(n[1].toString(16))+w(n[2].toString(16))}function O(t){for(var e={name:"Lao Lao",title:"general manager",children:[{name:"Bo Miao",title:"department manager"},{name:"Su Miao",title:"department manager",children:[{name:"Tie Hua",title:"senior engineer"},{name:"Hei Hei",title:"senior engineer",children:[{name:"Pang Pang",title:"engineer"},{name:"Xiang Xiang",title:"UE engineer"}]}]},{name:"Hong Miao",title:"department manager"}]},a=0;a<3;a++)e.children.push({name:"Lao Lao",title:"general manager",children:[{name:"Bo Miao",title:"department manager"},{name:"Su Miao",title:"department manager",children:[{name:"Tie Hua",title:"senior engineer"}]}]});for(var n=e,r=0;r<t;r++)n.children||(n.children=[]),n.children.push({name:"Lao Lao",title:"general manager",children:[{name:"Bo Miao",title:"department manager"},{name:"Su Miao",title:"department manager",children:[{name:"Tie Hua",title:"senior engineer"},{name:"Hei Hei",title:"senior engineer",children:[{name:"Xiang Xiang",title:"UE engineer"}]}]}]}),n=n.children[0];return e}function j(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"id-"+t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}var B=Object(k.a)({},n,{compose:function(){for(var t=arguments.length,e=new Array(t),a=0;a<t;a++)e[a]=arguments[a];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce((function(t,e){return function(){return t(e.apply(void 0,arguments))}}))},uuid:j,getRandomColor16:function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},text:function(t,e,a,n,r,i){t.font="14px Arial",t.fillStyle=i,t.fillText(e,a,n)},wrapText:function(t,e,a,n,r,i,o){t.fillStyle=o;for(var c=e.split(" "),s="",l=0;l<c.length;l++){var u=s+c[l]+" ";t.measureText(u).width>r&&l>0?(t.fillText(s,a,n),s=c[l]+" ",n+=i):s=u}t.fillText(s,a,n)},roundRect:function(t,e,a,n,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,o=arguments.length>6?arguments[6]:void 0,c=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];if("number"===typeof i)i={tl:i,tr:i,br:i,bl:i};else{var s={tl:0,tr:0,br:0,bl:0};for(var l in s)i[l]=i[l]||s[l]}t.beginPath(),t.moveTo(e+i.tl,a),t.lineTo(e+n-i.tr,a),t.quadraticCurveTo(e+n,a,e+n,a+i.tr),t.lineTo(e+n,a+r-i.br),t.quadraticCurveTo(e+n,a+r,e+n-i.br,a+r),t.lineTo(e+i.bl,a+r),t.quadraticCurveTo(e,a+r,e,a+r-i.bl),t.lineTo(e,a+i.tl),t.quadraticCurveTo(e,a,e+i.tl,a),t.closePath(),o&&t.fill(),c&&t.stroke()},generateOrgChartData:O,generateOrgChartDataFolded:function(t,e){for(var a=this.generateOrgChartData(t),n=a,r=0;r<e&&n.children;r++)n=n.children[0];return n._children=n.children,n.children=null,a}}),P=a(99),S=a(100),M=function(){function t(){Object(P.a)(this,t),this._width=600,this._height=400,this._margins={top:30,left:30,right:30,bottom:30},this._data=[],this._scaleX=null,this._scaleY=null,this._colors=y.scaleOrdinal(y.schemeCategory10),this._box=null,this._svg=null,this._body=null}return Object(S.a)(t,[{key:"width",value:function(t){return 0===arguments.length?this._width:(this._width=t,this)}},{key:"height",value:function(t){return 0===arguments.length?this._height:(this._height=t,this)}},{key:"margins",value:function(t){return 0===arguments.length?this._margins:(this._margins=t,this)}},{key:"data",value:function(t){return 0===arguments.length?this._data:(this._data=t,this)}},{key:"scaleX",value:function(t){return 0===arguments.length?this._scaleX:(this._scaleX=t,this)}},{key:"scaleY",value:function(t){return 0===arguments.length?this._scaleY:(this._scaleY=t,this)}},{key:"svg",value:function(t){return 0===arguments.length?this._svg:(this._svg=t,this)}},{key:"body",value:function(t){return 0===arguments.length?this._body:(this._body=t,this)}},{key:"box",value:function(t){return 0===arguments.length?this._box:(this._box=t,this)}},{key:"getBodyWidth",value:function(){var t=this._width-this._margins.left-this._margins.right;return t>0?t:0}},{key:"getBodyHeight",value:function(){var t=this._height-this._margins.top-this._margins.bottom;return t>0?t:0}},{key:"render",value:function(){return this}},{key:"bodyX",value:function(){return this._margins.left}},{key:"bodyY",value:function(){return this._margins.top}},{key:"defineBodyClip",value:function(){var t=this._svg.select("defs");t&&t.remove(),this._svg.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",this.getBodyWidth()+20).attr("height",this.getBodyHeight()+20).attr("x",-10).attr("y",-10)}},{key:"renderBody",value:function(){this._body||(this._body=this._svg.append("g").attr("class","chart-body").attr("transform","translate("+this.bodyX()+","+this.bodyY()+")").attr("clip-path","url(#clip)"))}},{key:"renderBox",value:function(){this._box||(this._box=y.select("body").append("div").attr("class","bar-chart-box"))}},{key:"renderSVG",value:function(){this._svg||(this._svg=this._box.append("svg").attr("width",this._width).attr("height",this._height))}},{key:"renderChart",value:function(){this.renderBox(),this.renderSVG(),this.defineBodyClip(),this.renderBody(),this.render()}}]),t}(),D=a(149),T=a.n(D);var Y=function(t){var e=t.config,a=t.className,n=void 0===a?"":a,o=Object(r.useRef)(j()),c=Object(r.useRef)(new M);return Object(r.useEffect)((function(){var t=y.select("#".concat(o.current)),a=c.current;a.box(t),a.margins(e.margins);var n=C.a.get(e,"data",[])||[],r=y.scaleBand().domain(n.map((function(t){return t.date}))).range([0,a.getBodyWidth()]).padding(e.barPadding);a.scaleX(r);var i=y.scaleLinear().domain([0,y.max(n,(function(t){return t.money}))]).range([a.getBodyHeight(),0]);a.scaleY(i),a.renderBars=function(){var t=a.body().selectAll(".bar-chart-bar").data(n);t.enter().append("rect").attr("class","bar-chart-bar").merge(t).attr("x",(function(t){return a.scaleX()(t.date)})).attr("y",a.scaleY()(0)).attr("width",a.scaleX().bandwidth()).attr("height",0).attr("fill",e.barColor).transition().duration(e.animateDuration).attr("height",(function(t){return a.getBodyHeight()-a.scaleY()(t.money)})).attr("y",(function(t){return a.scaleY()(t.money)})),t.exit().remove()},a.renderX=function(){a.svg().select(".bar-chart-xaxis").remove(),a.svg().insert("g",".chart-body").attr("transform","translate(".concat(a.bodyX(),", ").concat(a.bodyY()+a.getBodyHeight(),")")).attr("class","bar-chart-xaxis").call(y.axisBottom(a.scaleX()))},a.renderY=function(){a.svg().select(".bar-chart-yaxis").remove(),a.svg().insert("g",".chart-body").attr("transform","translate(".concat(a.bodyX(),", ").concat(a.bodyY(),")")).attr("class","bar-chart-yaxis").call(y.axisLeft(a.scaleY()))},a.renderText=function(){y.select(".bar-chart-xaxis").append("text").attr("class","bar-chart-axisText").attr("x",a.getBodyWidth()).attr("y",0).attr("fill",e.textColor).attr("dy",30).text("\u65e5\u671f"),y.select(".bar-chart-yaxis").append("text").attr("class","bar-chart-axisText").attr("x",0).attr("y",0).attr("fill",e.textColor).attr("transform","rotate(-90)").attr("dy",-40).attr("text-anchor","end").text("\u6bcf\u65e5\u6536\u5165 (\u5143)")},a.renderGrid=function(){y.selectAll(".bar-chart-yaxis .tick").each((function(t){e.tickShowGrid.indexOf(t)>-1&&y.select(this).append("line").attr("class","bar-chart-grid").attr("stroke",e.gridColor).attr("x1",0).attr("y1",0).attr("x2",a.getBodyWidth()).attr("y2",0)}))},a.renderAxis=function(){a.renderX(),a.renderY(),a.renderText(),a.renderGrid()},a.addMouseOn=function(){y.selectAll(".bar-chart-bar").on("mouseover",(function(t){var n=y.event,r=y.mouse(a.svg().node());y.select(n.target).attr("fill",e.hoverColor),a.svg().append("text").classed("bar-chart-tip",!0).attr("x",r[0]+5).attr("y",r[1]).attr("fill",e.textColor).text("\u6536\u5165: ".concat(t.money,"\u5143"))})).on("mouseleave",(function(){var t=y.event;y.select(t.target).attr("fill",a._colors(0)),y.select(".bar-chart-tip").remove()})).on("mousemove",(function(){var t=y.mouse(a.svg().node());y.select(".bar-chart-tip").attr("x",t[0]+5).attr("y",t[1]-5)}))},a.render=function(){a.renderBars(),a.renderAxis(),a.addMouseOn()},a.renderChart()}),[e]),i.a.createElement("div",{id:o.current,className:b()(T.a.barchart,n,"bar-chart-box")})},H=a(150),A=a.n(H);var L=function(){var t=Object(r.useState)([]),e=Object(p.a)(t,2),a=e[0],n=e[1];Object(r.useEffect)((function(){!function(){var t;v.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.awrap(y.csv("/D3-Learning/data.csv",(function(t){return{date:t.date,money:+t.money}})));case 3:t=e.sent,console.log("readData: ",t),n(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("e: ",e.t0);case 11:case"end":return e.stop()}}),null,null,[[0,8]])}()}),[]);var o=Object(r.useMemo)((function(){return{data:a,title:"\u6761\u5f62\u56fe",margins:{top:80,left:80,bottom:50,right:80},barPadding:.15,barColor:"#096dd9",textColor:"black",gridColor:"gray",tickShowGrid:[60,120,180],hoverColor:"#40a9ff",animateDuration:1e3}}),[a]);return i.a.createElement("div",{className:A.a.barChartPage},i.a.createElement(Y,{config:o}))},X=a(93),R=a.n(X),W=a(151),U=a.n(W);var G=function(t){var e=t.config,a=t.className,n=void 0===a?"":a,o=Object(r.useRef)(j()),c=Object(r.useRef)(new M);return Object(r.useEffect)((function(){var t=y.select("#".concat(o.current)),a=c.current;a.box(t),a.margins(e.margins);var n=C.a.get(e,"data",[])||[],r=y.timeParse("%Y-%m-%d"),i=y.scaleUtc().domain(y.extent(n,(function(t){return r(t.date)}))).range([0,a.getBodyWidth()]),s=y.scaleLinear().domain([0,y.max(n,(function(t){return t.value}))]).nice().range([a.getBodyHeight(),0]),l=y.line().defined((function(t){return!Number.isNaN(+t.value)})).x((function(t){return i(r(t.date))})).y((function(t){return s(t.value)})),u=function(t){return t.attr("class","line-chart-xaxis").attr("transform","translate(".concat(a.bodyX(),", ").concat(a.bodyY()+a.getBodyHeight(),")")).call(y.axisBottom(i).ticks(a.width()/80).tickSizeOuter(0))},d=function(t){return t.attr("class","line-chart-yaxis").attr("transform","translate(".concat(a.bodyX(),", ").concat(a.bodyY(),")")).call(y.axisLeft(s)).call((function(t){return t.select(".tick:last-of-type text").clone().attr("x",3).attr("text-anchor","start").attr("font-weight","bold").text("$ Close")}))};a.renderAxis=function(){a.svg().select(".line-chart-xaxis").remove(),a.svg().select(".line-chart-yaxis").remove(),a.svg().append("g").call(u),a.svg().append("g").call(d)},a.renderLine=function(){a.svg().select(".line-chart-line-defined").remove(),a.svg().select(".line-chart-line").remove(),a.body().append("path").attr("class","line-chart-line-defined").datum(n.filter(l.defined())).attr("stroke",e.hoverColor).attr("fill","none").attr("d",l),a.body().append("path").attr("class","line-chart-line").datum(n).attr("stroke",e.lineColor).attr("stroke-width",1.5).attr("fill","none").attr("d",l)},a.render=function(){a.renderAxis(),a.renderLine()},a.renderChart()}),[e]),i.a.createElement("div",{id:o.current,className:b()(U.a.linechart,n,"line-chart-box")})},V=a(152),I=a.n(V);var K=function(){var t=Object(r.useState)([]),e=Object(p.a)(t,2),a=e[0],n=e[1];Object(r.useEffect)((function(){!function(){var t;v.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.awrap(y.csv("/D3-Learning/aapl.csv",(function(t){return{date:R()(t.date,"MMM D, YYYY").format("YYYY-MM-DD"),value:+t.val}})));case 3:t=e.sent,n(t.filter((function(t){return!Number.isNaN(t.value)})).map((function(t){return Object(k.a)({},t,{value:R()(t.date,"YYYY-MM-DD").month()<3?void 0:t.value})}))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("e: ",e.t0);case 10:case"end":return e.stop()}}),null,null,[[0,7]])}()}),[]);var o=Object(r.useMemo)((function(){return{data:a,title:"\u7ebf\u5f62\u56fe",margins:{top:80,left:80,bottom:50,right:80},barPadding:.15,lineColor:"#096dd9",textColor:"black",gridColor:"gray",hoverColor:"#40a9ff",animateDuration:1e3}}),[a]);return i.a.createElement("div",{className:I.a.lineChartPage},i.a.createElement(G,{config:o}))},z=a(153),F=a.n(z);var q=function(t){var e=t.config,a=t.className,n=void 0===a?"":a,o=Object(r.useRef)(j()),c=Object(r.useRef)(new M),s=Object(r.useRef)();return Object(r.useEffect)((function(){var t=y.select("#".concat(o.current)),a=c.current;a.box(t),a.margins(e.margins);var n=s.current.offsetHeight,r=s.current.offsetWidth;a.width(r),a.height(n);var i=C.a.get(e,"data",[])||[],l=y.scaleOrdinal().domain(i.map((function(t){return t.name}))).range(y.quantize((function(t){return y.interpolateSpectral(.8*t+.1)}),i.length).reverse()),u=y.arc().innerRadius(Math.min(a.getBodyWidth(),a.getBodyHeight())/4-1).outerRadius(Math.min(a.getBodyWidth(),a.getBodyHeight())/2-1),d=Math.min(a.getBodyWidth(),a.getBodyHeight())/2*.8,h=y.arc().innerRadius(d).outerRadius(d),f=y.pie().sort(null).value((function(t){return t.value}));a.renderPie=function(){var t=f(i);a.body().select(".pie-chart-pie").remove(),a.body().select(".pie-chart-pie-label").remove(),a.body().append("g").attr("transform","translate(".concat(a.getBodyWidth()/2,", ").concat(a.getBodyHeight()/2,")")).attr("class","pie-chart-pie").attr("stroke","white").selectAll("path").data(t).join("path").attr("fill",(function(t){return l(t.data.name)})).attr("d",u).append("title").text((function(t){return"".concat(t.data.name,": ").concat(t.data.value.toLocaleString())})),a.body().append("g").attr("transform","translate(".concat(a.getBodyWidth()/2,", ").concat(a.getBodyHeight()/2,")")).attr("class","pie-chart-pie-label").attr("font-family","sans-serif").attr("font-size",12).attr("text-anchor","middle").selectAll("text").data(t).join("text").attr("transform",(function(t){return"translate(".concat(h.centroid(t),")")})).call((function(t){return t.append("tspan")})).attr("y","-0.4em").attr("font-weight","bold").text((function(t){return t.data.name})).call((function(t){return t.filter((function(t){return t.endAngle-t.startAngle>.25})).append("tspan").attr("x",0).attr("y","0.7em").attr("fill-opacity",.7).text((function(t){return t.data.value.toLocaleString()}))}))},a.render=function(){a.renderPie()},a.renderChart()}),[e]),i.a.createElement("div",{ref:s,id:o.current,className:b()(F.a.piechart,n,"pie-chart-box")})},Q=a(154),J=a.n(Q);var Z=function(){var t=Object(r.useState)([]),e=Object(p.a)(t,2),a=e[0],n=e[1];Object(r.useEffect)((function(){!function(){var t;v.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.awrap(y.csv("/D3-Learning/population-by-age.csv"));case 3:t=e.sent,n(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("e: ",e.t0);case 10:case"end":return e.stop()}}),null,null,[[0,7]])}()}),[]);var o=Object(r.useMemo)((function(){return{data:a,title:"\u997c\u5f62\u56fe",margins:{top:80,left:80,bottom:50,right:80},textColor:"black",gridColor:"gray",animateDuration:1e3}}),[a]);return i.a.createElement("div",{className:J.a.pieChartPage},i.a.createElement(q,{config:o}))},$=a(54),tt=a(148),et=a(108),at=a(155),nt=a.n(at);var rt=function(t){var e=t.config,a=t.className,n=void 0===a?"":a,o=Object(r.useRef)(j()),c=Object(r.useRef)(new M),s=Object(r.useRef)();return Object(r.useEffect)((function(){var t=y.select("#".concat(o.current)),a=c.current;a.box(t),a.margins(e.margins);var n=s.current.offsetHeight,r=s.current.offsetWidth;a.width(r),a.height(n);var i=C.a.get(e,"data",{})||{},l=C.a.get(e,"cityData",[])||[],u=$.a().scale(750).center([105,38]).translate([a.getBodyWidth()/2,a.getBodyHeight()/2]),d=tt.a(u),h=y.scaleOrdinal(et.b[11]);a.renderMap=function(){i.features&&(a.body().selectAll(".map-path").remove(),a.body().selectAll("path").data(i.features).enter().append("path").attr("class","map-path").attr("d",d).attr("fill",(function(t,e){return h(e)})).attr("stroke","lightGray").attr("stroke-width",1).append("title").attr(""))},a.renderCity=function(){a.body().selectAll(".map-city").data(l).enter().append("g").attr("class","map-city").attr("transform",(function(t){var e=u([t.log,t.lat]);return"translate(".concat(e[0],", ").concat(e[1],")")})).append("circle").attr("r",4).attr("fill","blue").attr("class","map-city-point")},a.addEvent=function(){var t=y.select("#china-map-tooltip");a.body().selectAll(".map-city").on("mouseover",(function(e){t.html("\u5f53\u524d\u57ce\u5e02: "+e.name).style("left",y.event.pageX+20+"px").style("top",y.event.pageY+20+"px").style("opacity",1),y.select(this).select("circle").transition().duration(150).attr("r",8)})).on("mouseout",(function(){t.style("opacity",0),y.select(this).select("circle").transition().duration(150).attr("r",4)}))},a.render=function(){a.renderMap(),a.renderCity(),a.addEvent()},a.renderChart()}),[e]),i.a.createElement("div",{ref:s,id:o.current,className:b()(nt.a.map,n,"map-chart-map")})},it=a(156),ot=a.n(it);var ct=function(){var t=Object(r.useState)({}),e=Object(p.a)(t,2),a=e[0],n=e[1],o=Object(r.useState)({}),c=Object(p.a)(o,2),s=c[0],l=c[1];Object(r.useEffect)((function(){!function(){var t,e;v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,v.a.awrap(y.json("/D3-Learning/china.json"));case 3:return t=a.sent,n(t),a.next=7,v.a.awrap(y.json("/D3-Learning/city.json"));case 7:e=a.sent,l(e),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(0),console.log("e: ",a.t0);case 14:case"end":return a.stop()}}),null,null,[[0,11]])}()}),[]);var u=Object(r.useMemo)((function(){return{data:a,cityData:C.a.get(s,"cities",[]),title:"\u4e2d\u56fd\u5730\u56fe",margins:{top:80,left:80,bottom:50,right:80},textColor:"black",gridColor:"gray",animateDuration:1e3}}),[a,s]);return i.a.createElement("div",{className:ot.a.chinaMapPage},i.a.createElement(rt,{config:u}),i.a.createElement("div",{id:"china-map-tooltip"}))},st=a(157),lt=a.n(st);var ut=function(t){var e=t.config,a=t.className,n=void 0===a?"":a,o=Object(r.useRef)(j()),c=Object(r.useRef)(new M),s=Object(r.useRef)();return Object(r.useEffect)((function(){var t=y.select("#".concat(o.current)),a=c.current;a.box(t),a.margins(e.margins);var n=s.current.offsetHeight,r=s.current.offsetWidth;a.width(r),a.height(n);var i=C.a.get(e,"data",{}),l=r/6,u=y.tree().nodeSize([10,l]),d=y.linkHorizontal().x((function(t){return t.y})).y((function(t){return t.x})),h=y.hierarchy(i);h.x0=l/2,h.y0=0,h.descendants().forEach((function(t,e){t.id=e,t._children=t.children,t.depth&&7!==t.data.name.length&&(t.children=null)})),a.renderSVG=function(){a.defineBodyClip=function(){},a.svg()||a.svg(a.box().append("svg").attr("class","svg-container").attr("viewBox",[0,0,r,10]).style("font","10px sans-serif").style("user-select","none").attr("width",this._width).attr("height",this._height))},a.renderSVGTree=function(){a.body().select(".link").remove();var t=a.body().append("g").attr("class","link").attr("fill","none").attr("stroke","#555").attr("stroke-opacity",.4).attr("stroke-width",1.5);a.body().select(".node").remove();var n=a.body().append("g").attr("class","node").attr("cursor","pointer").attr("pointer-events","all");!function i(o){var c=y.event&&y.event.altKey?2500:250,s=h.descendants().reverse(),l=h.links();u(h);var f=h,g=h;h.eachBefore((function(t){t.x<f.x&&(f=t),t.x>g.x&&(g=t)}));var m=g.x-f.x+e.margins.top+e.margins.bottom,v=a.svg().transition().duration(c).attr("viewBox",[0,f.x-e.margins.top,r,m]).attr("preserveAspectRatio","xMinYMin meet").tween("resize",window.ResizeObserver?null:function(){return function(){return a.svg().dispatch("toggle")}}),p=n.selectAll("g").data(s,(function(t){return t.id})),x=p.enter().append("g").attr("class","node-node").attr("transform",(function(t){return"translate(".concat(o.y0,", ").concat(o.x0,")")})).attr("fill-opacity",0).attr("stroke-opacity",0).on("click",(function(t){t.children=t.children?null:t._children,i(t)}));x.append("circle").attr("class","node-circle").attr("r",2.5).attr("fill",(function(t){return t._children?"#555":"#999"})).attr("stroke-width",10);var b=p.merge(x);b.transition(v).attr("transform",(function(t){return"translate(".concat(t.y,", ").concat(t.x,")")})).attr("fill-opacity",1).attr("stroke-opacity",1),a.svg().selectAll("text").remove(),b.append("text").attr("dy","0.31em").attr("x",(function(t){return t.children?-6:6})).attr("text-anchor",(function(t){return t.children?"end":"start"})).text((function(t){return t.data.name})).clone(!0).lower().attr("stroke-linejoin","round").attr("stroke-width",3).attr("stroke","white"),p.exit().transition(v).remove().attr("transform",(function(t){return"translate(".concat(o.y,", ").concat(o.x,")")})).attr("fill-opacity",0).attr("stroke-opacity",0);var _=t.selectAll("path").data(l,(function(t){return t.target.id})),C=_.enter().append("path").attr("class","link-path").attr("d",(function(t){var e={x:o.x0,y:o.y0};return d({source:e,target:e})}));_.merge(C).transition(v).attr("d",d),_.exit().transition(v).attr("d",(function(t){var e={x:o.x,y:o.y};return d({source:e,target:e})})),h.eachBefore((function(t){t.x0=t.x,t.y0=t.y}))}(h)},a.render=function(){a.renderSVGTree()},a.renderChart()}),[e]),i.a.createElement("div",{ref:s,id:o.current,className:b()(lt.a.svgTree,n,"svg-tree")})},dt=a(158),ht=a.n(dt);var ft=function(){var t=Object(r.useState)({}),e=Object(p.a)(t,2),a=e[0],n=e[1];Object(r.useEffect)((function(){!function(){var t;v.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.awrap(y.json("/D3-Learning/flare-2.json"));case 3:t=e.sent,n(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("e: ",e.t0);case 10:case"end":return e.stop()}}),null,null,[[0,7]])}()}),[]);var o=Object(r.useMemo)((function(){return{data:a,title:"\u6811\u72b6\u56fe",margins:{top:80,left:80,bottom:50,right:80},textColor:"black",gridColor:"gray",animateDuration:1e3}}),[a]);return i.a.createElement("div",{className:ht.a.svgTreePage},i.a.createElement(ut,{config:o}))},gt=function(){function t(e,a){Object(P.a)(this,t),this.containerDom=e,this.config=a,this.d3=y,this.init()}return Object(S.a)(t,[{key:"init",value:function(){this.initVariables(),this.initCanvas(),this.initVirtualNode(),this.setCanvasListener()}},{key:"initVariables",value:function(){this.height=this.containerDom.offsetHeight,this.width=this.containerDom.offsetWidth,this.padding=20,this.nodeWidth=180,this.nodeHeight=280,this.unitPadding=20,this.unitWidth=140,this.unitHeight=100,this.duration=600,this.scale=1}},{key:"initCanvas",value:function(){this.container=this.d3.select(this.containerDom),this.canvasNode=this.container.append("canvas").attr("class","canvas-tree-canvas").attr("width",this.width).attr("height",this.height),this.hiddenCanvasNode=this.container.append("canvas").attr("class","canvas-tree-canvas").attr("width",this.width).attr("height",this.height).style("display","none"),this.context=this.canvasNode.node().getContext("2d"),this.context.translate(this.width/2,this.padding),this.hiddenContext=this.hiddenCanvasNode.node().getContext("2d"),this.hiddenContext.translate(this.width/2,this.padding)}},{key:"initVirtualNode",value:function(){var t=document.createElement("root");this.virtualContainerNode=this.d3.select(t),this.colorNodeMap={}}},{key:"setCanvasListener",value:function(){this.setClickListener(),this.setDragListener(),this.setMouseWheelZoomListener()}},{key:"setClickListener",value:function(){var t=this;this.canvasNode.node().addEventListener("click",(function(e){var a=B.getColorStrFromCanvas(t.hiddenContext,e.layerX,e.layerY),n=t.colorNodeMap[a];n&&(t.toggleTreeNode(n.data()[0]),t.update(n.data()[0]))}))}},{key:"toggleTreeNode",value:function(t){t.children?(t._children=t.children,t.children=null):(t.children=t._children,t._children=null)}},{key:"setDragListener",value:function(){this.onDrag_=!1,this.dragStartPoint_={x:0,y:0};var t=this;this.canvasNode.node().onmousedown=function(e){t.dragStartPoint_.x=e.x,t.dragStartPoint_.y=e.y,t.onDrag_=!0},this.canvasNode.node().onmousemove=function(e){t.onDrag_&&(t.context.translate((e.x-t.dragStartPoint_.x)/t.scale,(e.y-t.dragStartPoint_.y)/t.scale),t.hiddenContext.translate((e.x-t.dragStartPoint_.x)/t.scale,(e.y-t.dragStartPoint_.y)/t.scale),t.dragStartPoint_.x=e.x,t.dragStartPoint_.y=e.y)},this.canvasNode.node().onmouseout=function(e){t.onDrag_&&(t.onDrag_=!1)},this.canvasNode.node().onmouseup=function(e){t.onDrag_&&(t.onDrag_=!1)}}},{key:"setMouseWheelZoomListener",value:function(){var t=this;this.canvasNode.node().addEventListener("mousewheel",(function(e){e.preventDefault(),e.deltaY<0?t.bigger():t.smaller()}))}},{key:"bigger",value:function(){this.scale>7||(this.clearCanvas_(),this.scale=5*this.scale/4,this.context.scale(5/4,5/4),this.hiddenContext.scale(5/4,5/4))}},{key:"smaller",value:function(){this.scale<.2||(this.clearCanvas_(),this.scale=4*this.scale/5,this.context.scale(.8,.8),this.hiddenContext.scale(.8,.8))}},{key:"clearCanvas_",value:function(){this.context.clearRect(-1e6,-1e4,2e6,2e6),this.hiddenContext.clearRect(-1e6,-1e4,2e6,2e6)}},{key:"draw",value:function(t){this.data=this.d3.hierarchy(t),this.treeGenerator=this.d3.tree().nodeSize([this.nodeWidth,this.nodeHeight]),this.update();var e=this;this.d3.timer((function(){e.drawCanvas()}))}},{key:"update",value:function(t){this.treeData=this.treeGenerator(this.data);var e=this.treeData.descendants(),a=this.treeData.links(),n=0,r=0,i=0,o=0;t&&(n=t.x0,r=t.y0,i=t.x,o=t.y),this.updateOrgUnits(e,n,r,i,o),this.updateLinks(a,n,r,i,o),this.addColorKey(),this.bindNodeToTreeData()}},{key:"updateOrgUnits",value:function(t,e,a,n,r){var i=this.virtualContainerNode.selectAll(".orgUnit").data(t,(function(t){return t.colorKey}));i.attr("class","orgUnit").attr("x",(function(t){return t.x0})).attr("y",(function(t){return t.y0})).transition().duration(this.duration).attr("x",(function(t){return t.x})).attr("y",(function(t){return t.y})).attr("fillStyle","#ff0000"),i.enter().append("orgUnit").attr("class","orgUnit").attr("x",e).attr("y",a).transition().duration(this.duration).attr("x",(function(t){return t.x})).attr("y",(function(t){return t.y})).attr("fillStyle","#ff0000"),i.exit().transition().duration(this.duration).attr("x",n).attr("y",r).remove(),t.forEach((function(t){t.x0=t.x,t.y0=t.y}))}},{key:"updateLinks",value:function(t,e,a,n,r){var i=this.virtualContainerNode.selectAll(".link").data(t,(function(t){return t.source.colorKey+":"+t.target.colorKey}));i.attr("class","link").attr("sourceX",(function(t){return t.source.x00})).attr("sourceY",(function(t){return t.source.y00})).attr("targetX",(function(t){return t.target.x00})).attr("targetY",(function(t){return t.target.y00})).transition().duration(this.duration).attr("sourceX",(function(t){return t.source.x})).attr("sourceY",(function(t){return t.source.y})).attr("targetX",(function(t){return t.target.x})).attr("targetY",(function(t){return t.target.y})),i.enter().append("link").attr("class","link").attr("sourceX",e).attr("sourceY",a).attr("targetX",e).attr("targetY",a).transition().duration(this.duration).attr("sourceX",(function(t){return t.source.x})).attr("sourceY",(function(t){return t.source.y})).attr("targetX",(function(t){return t.target.x})).attr("targetY",(function(t){return t.target.y})),i.exit().transition().duration(this.duration).attr("sourceX",n).attr("sourceY",r).attr("targetX",n).attr("targetY",r).remove(),t.forEach((function(t){t.source.x00=t.source.x,t.source.y00=t.source.y,t.target.x00=t.target.x,t.target.y00=t.target.y})),i=null}},{key:"addColorKey",value:function(){var t=this;this.virtualContainerNode.selectAll(".orgUnit").each((function(){for(var e=t.d3.select(this),a=B.randomColor();t.colorNodeMap[a];)a=B.randomColor();e.attr("colorKey",a),e.data()[0].colorKey=a,t.colorNodeMap[a]=e}))}},{key:"bindNodeToTreeData",value:function(){var t=this;this.virtualContainerNode.selectAll(".orgUnit").each((function(){var e=t.d3.select(this);e.data()[0].node=e}))}},{key:"drawCanvas",value:function(){this.drawShowCanvas(),this.drawHiddenCanvas()}},{key:"drawShowCanvas",value:function(){this.context.clearRect(-5e4,-1e4,1e5,1e5);var t=this;this.virtualContainerNode.selectAll(".link").each((function(){var e=t.d3.select(this),a=t.d3.linkVertical().x((function(t){return t.x})).y((function(t){return t.y})).source((function(){return{x:e.attr("sourceX"),y:e.attr("sourceY")}})).target((function(){return{x:e.attr("targetX"),y:e.attr("targetY")}})),n=new Path2D(a());t.context.stroke(n)})),this.virtualContainerNode.selectAll(".orgUnit").each((function(){var e=t.d3.select(this),a=e.data()[0].data;t.context.fillStyle="#3ca0ff";var n=Number(e.attr("x"))-t.unitWidth/2,r=Number(e.attr("y"))-t.unitHeight/2;B.roundRect(t.context,n,r,t.unitWidth,t.unitHeight,4,!0,!1),B.text(t.context,a.name,n+t.unitPadding,r+t.unitPadding,"20px","#ffffff");var i=t.unitWidth-2*t.unitPadding;B.wrapText(t.context,a.title,n+t.unitPadding,r+t.unitPadding+24,i,20)}))}},{key:"drawHiddenCanvas",value:function(){this.hiddenContext.clearRect(-5e4,-1e4,1e5,1e5);var t=this;this.virtualContainerNode.selectAll(".orgUnit").each((function(){var e=t.d3.select(this);t.hiddenContext.fillStyle=e.attr("colorKey"),B.roundRect(t.hiddenContext,Number(e.attr("x"))-t.unitWidth/2,Number(e.attr("y"))-t.unitHeight/2,t.unitWidth,t.unitHeight,4,!0,!1)}))}}]),t}(),mt=a(159),vt=a.n(mt);var pt=function(t){var e=t.config,a=void 0===e?{}:e,n=Object(r.useRef)(),o=Object(r.useMemo)((function(){return O(10)}),[]);return Object(r.useEffect)((function(){var t=new gt(n.current,a);console.log("containerRef width: ",n.current.offsetWidth),console.log("containerRef width: ",n.current.offsetHeight),t.draw(o)}),[o,a]),i.a.createElement("div",{ref:n,className:vt.a.canvasTree})},yt=a(160),xt=a.n(yt);var bt=function(){return i.a.createElement("div",{className:xt.a.CanvasTreePage},i.a.createElement(pt,null))},_t=a(50),Ct=a.n(_t),kt=l.a.Header,Et=l.a.Footer,wt=l.a.Sider,Nt=l.a.Content;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement((function(){return i.a.createElement(u.a,{basename:"/D3-Learning"},i.a.createElement("div",{className:Ct.a.app},i.a.createElement(l.a,{className:Ct.a.container},i.a.createElement(kt,null,i.a.createElement(s.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:["1"],style:{lineHeight:"64px"}},i.a.createElement(s.a.Item,{key:"1"},"D3"))),i.a.createElement(l.a,{className:Ct.a.body},i.a.createElement(wt,{className:Ct.a.sider},i.a.createElement(s.a,{className:Ct.a.sideBarMenu,theme:"light",mode:"inline",defaultSelectedKeys:["home"]},i.a.createElement(s.a.Item,{key:"home"},i.a.createElement(u.b,{className:"nav-text",to:"/home"},"home")),i.a.createElement(s.a.Item,{key:"bar"},i.a.createElement(u.b,{className:"nav-text",to:"/bar"},"bar chart")),i.a.createElement(s.a.Item,{key:"line"},i.a.createElement(u.b,{className:"nav-text",to:"/line"},"line chart")),i.a.createElement(s.a.Item,{key:"pie"},i.a.createElement(u.b,{className:"nav-text",to:"/pie"},"pie chart")),i.a.createElement(s.a.Item,{key:"map"},i.a.createElement(u.b,{className:"nav-text",to:"/map"},"map chart")),i.a.createElement(s.a.Item,{key:"svgTree"},i.a.createElement(u.b,{className:"nav-text",to:"/svg-tree"},"svg tree")),i.a.createElement(s.a.Item,{key:"canvasTree"},i.a.createElement(u.b,{className:"nav-text",to:"/canvas-tree"},"canvas tree")))),i.a.createElement(Nt,{className:Ct.a.main},i.a.createElement(d.d,null,i.a.createElement(d.b,{path:"/home"},i.a.createElement(g,null)),i.a.createElement(d.b,{path:"/bar"},i.a.createElement(L,null)),i.a.createElement(d.b,{path:"/line"},i.a.createElement(K,null)),i.a.createElement(d.b,{path:"/pie"},i.a.createElement(Z,null)),i.a.createElement(d.b,{path:"/map"},i.a.createElement(ct,null)),i.a.createElement(d.b,{path:"/svg-tree"},i.a.createElement(ft,null)),i.a.createElement(d.b,{path:"/canvas-tree"},i.a.createElement(bt,null)),i.a.createElement(d.b,{exact:!0,path:"/"},i.a.createElement(d.a,{to:"/home"}))))),i.a.createElement(Et,{className:Ct.a.footer},"Footer"))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},50:function(t,e,a){t.exports={app:"App_app__2ziFi",container:"App_container__eSJ6i",body:"App_body__2a4FT",sideBarMenu:"App_sideBarMenu__PtotW",sider:"App_sider__1ouFU",main:"App_main__uN9ca",footer:"App_footer__3csul"}}},[[168,1,2]]]);
//# sourceMappingURL=main.20e5c148.chunk.js.map